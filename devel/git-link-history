#!/usr/bin/env bash

set -e

if [ $# -ne 2 ]; then
	echo "Usage: git link-history <current-branch> <history-branch>"
	echo ""
	echo "Prepend <history> as a parent of the initial commit of <current>."
	exit 2
fi

newtail=$(git rev-list "$1" | tail -1)
oldhead=$(git rev-parse --verify "$2")

git fake-parent "$newtail" "$oldhead"

git log -n 2 --decorate "$newtail"

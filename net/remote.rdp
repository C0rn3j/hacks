#!/usr/bin/env bash
. libcred.bash

host=$1
[[ $host ]] || exit 2

args=(-N -P -r "disk:home=$HOME" -r "disk:root=/"
	-r "sound:local" -r "clipboard:CLIPBOARD"
	-D -g "workarea" "$@")

getcred_var "$host" "tsclient" "Remote Desktop" user pass

[[ $user ]] && args+=(-u "$user")
[[ $pass ]] && args+=(-p -)

printf '%s\n' "$pass" |
exec rdesktop "${args[@]}"

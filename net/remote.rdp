#!/usr/bin/env bash
. libcred.bash

host=$1
[[ $host ]] || exit 2

args=(-N -P -z
	-r "disk:home=$HOME"
	-r "disk:root=/"
	-r "sound:local:libao"
	-r "clipboard:CLIPBOARD"
	-T "Remote Desktop: $host"
	"$@")

getcred_var "$host" "tsclient" "Remote Desktop" user pass || exit

[[ $user ]] && args+=(-u "$user")
[[ $pass ]] && args+=(-p -)

printf '%s\n' "$pass" |
exec rdesktop "${args[@]}"

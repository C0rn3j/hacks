#!/usr/bin/env perl
use v5.14;
use warnings;
use strict;
use List::MoreUtils qw(uniq);
use Net::DNS;

my $res = Net::DNS::Resolver->new;

my $domain = "nullroute.eu.org";

my $srv_ans = $res->send("_ldap._tcp.$domain", "SRV");

my @hosts =
	uniq map {"ldaps://$_"} map {$_->target}
	sort {$a->priority <=> $b->priority}
	sort {$a->weight <=> $b->weight}
	sort {$a->target cmp $b->target}
	grep {$_->type eq 'SRV'} $srv_ans->answer;

say "URI ldapi:// @hosts";

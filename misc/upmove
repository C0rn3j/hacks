#!/usr/bin/env bash
# moves files from a given directory to one level above

. lib.bash || exit

for dir; do
	dir=${dir%/}

	shopt -s dotglob

	for file in "$dir"/*; do
		file=${file#"$dir/"}
		if [[ "$file" == . || "$file" == .. ]]; then
			continue
		elif [[ -e "$file" ]]; then
			err "file would conflict: '$file'"
		fi
	done

	(( ! errors )) || exit

	find "$dir" -mindepth 1 -maxdepth 1 \
		-not -name "$dir" \
		-print -exec mv -t "$PWD" {} +

	rmdir -v "$dir"
done

#!/bin/sh
# nproc - fallback 'nproc' util for coreutils < 8.0

if [ -n "$OMP_NUM_THREADS" ]; then
	echo $OMP_NUM_THREADS
	exit
fi

case `uname` in
Linux)
	exec getconf _NPROCESSORS_ONLN
	;;
FreeBSD|NetBSD)
	exec /sbin/sysctl -n hw.ncpu
	;;
SunOS)
	exec /usr/sbin/psrinfo -p
	;;
*)
	echo "fbin/nproc: unsupported OS '`uname`'" >&2
	echo 1
	;;
esac
